<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
  <title>Acta de Entrega - RAMO</title>
  
  <style>
    /* --- ESTILOS --- */
    * { box-sizing: border-box; }
    body, html { margin: 0; padding: 0; font-family: "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #f4f6f8; color: #333; }
    
    .main-container { max-width: 800px; margin: 20px auto; background-color: #fff; border-radius: 8px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); overflow: hidden; padding-bottom: 30px; }
    
    header { text-align: center; padding: 20px; background: #fff; border-bottom: 2px solid #B70000; }
    .logo { max-width: 150px; margin-bottom: 10px; display: block; margin-left: auto; margin-right: auto; }
    h1 { font-size: 1.3rem; color: #B70000; margin: 0; font-weight: 700; text-transform: uppercase; }

    .condiciones-uso { background-color: #fffbfb; border: 1px solid #eecaca; margin: 15px 20px; padding: 15px; font-size: 0.8rem; color: #555; line-height: 1.4; text-align: justify; border-radius: 6px; }
    .condiciones-uso h3 { margin-top: 0; color: #B70000; font-size: 0.9rem; }
    .condiciones-uso p { margin-bottom: 6px; }

    form { padding: 0 20px; }
    
    .seccion-header { background-color: #333; color: #fff; padding: 10px; margin-top: 25px; margin-bottom: 15px; border-radius: 4px; font-weight: 600; display: flex; align-items: center; font-size: 0.95rem; }
    .seccion-header .numero { background-color: #B70000; color: white; width: 22px; height: 22px; border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-right: 10px; font-size: 0.8rem; }

    .grid-2 { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
    .grid-3 { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 15px; }

    label { display: block; margin-top: 12px; margin-bottom: 4px; font-weight: 600; font-size: 0.85rem; color: #444; }
    
    input, select, textarea { width: 100%; padding: 10px; border: 1px solid #ccc; border-radius: 4px; font-size: 1rem; background-color: #fff; }
    input:focus, select:focus, textarea:focus { border-color: #B70000; outline: none; box-shadow: 0 0 0 2px rgba(183,0,0,0.1); }
    
    .input-readonly { background-color: #f2f2f2; color: #666; border-color: #e0e0e0; pointer-events: none; }

    .input-group-search { display: flex; gap: 8px; }
    .btn-search { background-color: #B70000; color: white; border: none; padding: 0 15px; border-radius: 4px; font-weight: bold; display: flex; align-items: center; justify-content: center; cursor: pointer; }
    .msg-estado { margin-top: 5px; font-size: 0.85rem; font-weight: bold; min-height: 20px;}

    /* TARJETAS M√ìVILES */
    .accesorios-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 15px; margin-top: 15px; }
    .accesorio-card { background: #fff; border: 1px solid #ddd; border-radius: 8px; padding: 15px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
    .acc-header { font-weight: bold; color: #B70000; border-bottom: 1px solid #eee; padding-bottom: 8px; margin-bottom: 10px; font-size: 1rem; }
    .acc-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
    .acc-label { font-size: 0.85rem; color: #555; }
    
    .radio-group-mobile { display: flex; gap: 15px; }
    .radio-group-mobile label { display: flex; align-items: center; font-weight: normal; margin: 0; cursor: pointer; font-size: 0.9rem; }
    .radio-group-mobile input { width: 20px; height: 20px; margin-right: 5px; accent-color: #B70000; }
    .obs-item { margin-top: 8px; font-size: 0.9rem; padding: 8px; border: 1px solid #eee; background: #fafafa; }

    .firmas-wrapper { margin-top: 15px; }
    .firma-card { border: 1px solid #ddd; padding: 10px; text-align: center; border-radius: 6px; background: #fafafa; }
    .canvas-firma { border: 2px dashed #ccc; background: #fff; width: 100%; height: 140px; touch-action: none; border-radius: 4px; }
    .btn-clear { background: #fff; border: 1px solid #ccc; padding: 6px 12px; border-radius: 4px; margin-top: 8px; font-size: 0.8rem; }

    .btn-principal { width: 100%; padding: 16px; background-color: #B70000; color: white; border: none; border-radius: 6px; font-size: 1.1rem; font-weight: bold; cursor: pointer; margin-top: 25px; text-transform: uppercase; box-shadow: 0 4px 6px rgba(183,0,0,0.2); }
    .btn-principal:active { transform: scale(0.98); }
    
    .spinner { display: inline-block; width: 16px; height: 16px; border: 3px solid rgba(255,255,255,0.3); border-radius: 50%; border-top-color: #fff; animation: spin 1s ease-in-out infinite; vertical-align: middle; }
    @keyframes spin { to { transform: rotate(360deg); } }

    @media (max-width: 600px) {
        .main-container { margin: 0; border-radius: 0; box-shadow: none; }
        .grid-2, .grid-3 { grid-template-columns: 1fr; }
        .input-group-search { flex-direction: column; }
        .btn-search { width: 100%; padding: 12px; }
        .accesorios-grid { grid-template-columns: 1fr; }
    }
  </style>
</head>
<body>

<div class="main-container">
    <header>
        <img src="logo-ramo.png" alt="Logo RAMO" class="logo" />
        <h1>Acta de Entrega de Dispositivos M√≥viles</h1>
    </header>

    <div class="condiciones-uso">
        <h3>Condiciones de uso:</h3>
        <p>Los elementos son de uso exclusivo de la Organizaci√≥n Ramo para la ejecuci√≥n de sus actividades Comerciales.</p>
        <p>El anterior equipo y los accesorios no podr√°n ser utilizados para otras labores distintas a las establecidas para la venta, ni manipulados por terceras personas.</p>
        <p>Cualquier da√±o o p√©rdida por negligencia har√° responsable al funcionario del costo estipulado.</p>
        <p>En caso de novedad, informar al Jefe inmediato para tr√°mite respectivo.</p>
        <p>Si el funcionario se retira, deber√° entregar los elementos en las mismas condiciones.</p>
    </div>

    <form id="formulario">
        
        <!-- 1. COLABORADOR -->
        <div class="seccion-header"><span class="numero">1</span> Datos del Colaborador (Recibe)</div>

        <div class="grid-2">
            <div><label>Ciudad:</label><input type="text" id="ciudad" required placeholder="Ej: Bogot√°"></div>
            <div><label>Fecha:</label><input type="text" id="fecha" readonly class="input-readonly"></div>
        </div>

        <label>C√©dula Colaborador:</label>
        <div class="input-group-search">
            <input type="text" id="cedula" inputmode="numeric" required placeholder="Sin puntos">
            <button type="button" class="btn-search" onclick="buscarColaborador()">
                <span id="icono-busqueda-colaborador">üîç</span> Buscar
            </button>
        </div>
        <div id="msg-colaborador" class="msg-estado"></div>

        <label>Nombre Completo:</label><input type="text" id="nombre_colaborador" readonly class="input-readonly">
        
        <div class="grid-2">
            <div><label>Agencia:</label><input type="text" id="agencia" readonly class="input-readonly"></div>
            <div><label>Tel√©fono:</label><input type="text" id="telefono" readonly class="input-readonly"></div>
        </div>

        <label>Correo Electr√≥nico:</label>
        <input type="email" id="correo_colaborador" required placeholder="nombre@ramo.com.co">

        <div class="grid-2">
            <!-- NUEVO CAMPO: C√ìDIGO SAP COLABORADOR -->
            <div><label>C√≥digo SAP Colaborador:</label><input type="text" id="codigo_sap" inputmode="numeric" required placeholder="Ej: 12345"></div>
            <div><label>Zona:</label><input type="text" id="zona_colaborador" required></div>
        </div>

        <label>Cargo / Operaci√≥n:</label>
        <select id="operacion" required>
            <option value="">Seleccione...</option>
            <option value="Gestor PV">Gestor PV</option>
            <option value="Preventa">Preventa</option>
            <option value="Canal Moderno">Canal Moderno</option>
            <option value="Log√≠stica">Log√≠stica</option>
            <option value="Eagle">Eagle</option>
            <option value="Administrativo">Administrativo</option>
            <option value="Agencia">Agencia</option>
        </select>

        <!-- 2. INVENTARIO -->
        <div class="seccion-header"><span class="numero">2</span> Inventario del Dispositivo</div>

        <div class="grid-3">
            <div><label>Tipo:</label><input type="text" id="tipo_equipo" value="Handheld" readonly class="input-readonly" style="color:#B70000; font-weight:bold;"></div>
            <div>
                <label>Marca:</label>
                <select id="marca" required>
                    <option value="">Seleccione...</option>
                    <option value="Zebra">Zebra</option>
                    <option value="Samsung">Samsung</option>
                    <option value="Cyrus">Cyrus</option>
                    <option value="Ulefone">Ulefone</option>
                </select>
            </div>
            <div>
                <label>Modelo:</label>
                <select id="modelo" required>
                    <option value="">Seleccione...</option>
                    <option value="TC26">TC26</option>
                    <option value="TC27">TC27</option>
                    <option value="Armor X8">Armor X8</option>
                    <option value="Armor X8i">Armor X8i</option>
                    <option value="J5">J5</option>
                    <option value="Otro">Otro</option>
                </select>
            </div>
        </div>

        <label>Serial (IMEI/SN):</label>
        <input type="text" id="serial" required placeholder="Escanee o digite">

        <div class="seccion-header" style="background:#B70000; margin-top:30px;"><span class="numero" style="background:#fff; color:#B70000;">‚úì</span> Estado de Accesorios</div>
        
        <div class="accesorios-grid">
            <!-- Cards Accesorios -->
            <div class="accesorio-card">
                <div class="acc-header">Terminal M√≥vil</div>
                <div class="acc-row"><span class="acc-label">¬øEntrega?</span><div class="radio-group-mobile"><label><input type="radio" name="entrega_terminal" value="Si" checked>Si</label><label><input type="radio" name="entrega_terminal" value="No">No</label></div></div>
                <div class="acc-row"><span class="acc-label">Estado:</span><select name="estado_terminal"><option value="Bueno">Bueno</option><option value="Regular">Regular</option><option value="Malo">Malo</option></select></div>
                <input type="text" id="obs_terminal" class="obs-item" placeholder="Observaci√≥n...">
            </div>

            <div class="accesorio-card">
                <div class="acc-header">Pantalla</div>
                <div class="acc-row"><span class="acc-label">¬øEntrega?</span><div class="radio-group-mobile"><label><input type="radio" name="entrega_pantalla" value="Si" checked>Si</label><label><input type="radio" name="entrega_pantalla" value="No">No</label></div></div>
                <div class="acc-row"><span class="acc-label">Estado:</span><select name="estado_pantalla"><option value="Bueno">Bueno</option><option value="Regular">Regular</option><option value="Malo">Malo</option></select></div>
                <input type="text" id="obs_pantalla" class="obs-item" placeholder="Observaci√≥n...">
            </div>

            <div class="accesorio-card">
                <div class="acc-header">Estuche</div>
                <div class="acc-row"><span class="acc-label">¬øEntrega?</span><div class="radio-group-mobile"><label><input type="radio" name="entrega_estuche" value="Si">Si</label><label><input type="radio" name="entrega_estuche" value="No" checked>No</label></div></div>
                <div class="acc-row"><span class="acc-label">Estado:</span><select name="estado_estuche"><option value="N/A">N/A</option><option value="Bueno">Bueno</option><option value="Regular">Regular</option><option value="Malo">Malo</option></select></div>
                <input type="text" id="obs_estuche" class="obs-item" placeholder="Observaci√≥n...">
            </div>

            <div class="accesorio-card">
                <div class="acc-header">Bater√≠a</div>
                <div class="acc-row"><span class="acc-label">¬øEntrega?</span><div class="radio-group-mobile"><label><input type="radio" name="entrega_bateria" value="Si">Si</label><label><input type="radio" name="entrega_bateria" value="No" checked>No</label></div></div>
                <div class="acc-row"><span class="acc-label">Estado:</span><select name="estado_bateria_item"><option value="N/A">N/A</option><option value="Bueno">Bueno</option><option value="Regular">Regular</option><option value="Malo">Malo</option></select></div>
                <input type="text" id="obs_bateria" class="obs-item" placeholder="Observaci√≥n...">
            </div>

            <div class="accesorio-card">
                <div class="acc-header">Cargador</div>
                <div class="acc-row"><span class="acc-label">¬øEntrega?</span><div class="radio-group-mobile"><label><input type="radio" name="entrega_cargador" value="Si">Si</label><label><input type="radio" name="entrega_cargador" value="No" checked>No</label></div></div>
                <div class="acc-row"><span class="acc-label">Estado:</span><select name="estado_cargador"><option value="N/A">N/A</option><option value="Bueno">Bueno</option><option value="Regular">Regular</option><option value="Malo">Malo</option></select></div>
                <input type="text" id="obs_cargador" class="obs-item" placeholder="Observaci√≥n...">
            </div>

            <div class="accesorio-card">
                <div class="acc-header">Cable USB</div>
                <div class="acc-row"><span class="acc-label">¬øEntrega?</span><div class="radio-group-mobile"><label><input type="radio" name="entrega_cable" value="Si">Si</label><label><input type="radio" name="entrega_cable" value="No" checked>No</label></div></div>
                <div class="acc-row"><span class="acc-label">Estado:</span><select name="estado_cable"><option value="N/A">N/A</option><option value="Bueno">Bueno</option><option value="Regular">Regular</option><option value="Malo">Malo</option></select></div>
                <input type="text" id="obs_cable" class="obs-item" placeholder="Observaci√≥n...">
            </div>
        </div>

        <!-- NUEVO CAMPO: ACCESORIOS -->
        <label style="margin-top:20px;">Accesorios entregados (Escriba aqu√≠):</label>
        <textarea id="accesorios" rows="2" placeholder="Ej: Estuche, Cargador, Terminal..."></textarea>

        <label style="margin-top:15px;">Observaciones Generales:</label>
        <textarea id="observaciones" rows="3" placeholder="Comentarios generales de la entrega..."></textarea>

        <!-- 3. ANALISTA -->
        <div class="seccion-header"><span class="numero">3</span> Datos del Analista (Entrega)</div>

        <label>C√©dula Analista:</label>
        <div class="input-group-search">
            <input type="text" id="cedula_analista" inputmode="numeric" required placeholder="Sin puntos">
            <button type="button" class="btn-search" onclick="buscarAnalista()">
                <span id="icono-busqueda-analista">üîç</span> Buscar
            </button>
        </div>
        <div id="msg-analista" class="msg-estado"></div>

        <label>Nombre Analista:</label><input type="text" id="nombre_analista" readonly class="input-readonly">

        <div class="grid-2">
            <div><label>Agencia:</label><input type="text" id="agencia_analista" readonly class="input-readonly"></div>
            <div><label>Tel√©fono:</label><input type="text" id="telefono_analista" readonly class="input-readonly"></div>
        </div>

        <div class="grid-3">
            <div><label>C√≥d. SAP:</label><input type="text" id="codigo_sap_analista" required></div>
            <div><label>Cargo:</label><input type="text" id="cargo_analista" required></div>
            <div><label>Zona:</label><input type="text" id="zona_analista" required></div>
        </div>

        <!-- 4. FIRMAS -->
        <div class="seccion-header"><span class="numero">4</span> Firmas</div>
        <div class="grid-2 firmas-wrapper">
            <div class="firma-card">
                <label>Colaborador (Recibe)</label>
                <canvas id="canvas_colaborador" class="canvas-firma"></canvas>
                <button type="button" class="btn-clear" onclick="limpiarFirma('colab')">Borrar Firma</button>
            </div>
            <div class="firma-card">
                <label>Analista (Entrega)</label>
                <canvas id="canvas_analista" class="canvas-firma"></canvas>
                <button type="button" class="btn-clear" onclick="limpiarFirma('ana')">Borrar Firma</button>
            </div>
        </div>

        <div style="margin-top:20px; background:#f0f0f0; padding:15px; border-radius:6px;">
            <label style="display:flex; align-items:center;">
                <input type="checkbox" id="aceptaCondiciones" required style="width:20px; height:20px; margin-right:15px; margin-top:0;">
                <span>Certifico que la informaci√≥n es correcta y acepto las condiciones.</span>
            </label>
        </div>

        <button type="submit" class="btn-principal">GENERAR ACTA</button>
        <div id="estado-envio" style="text-align:center; margin-top:15px; font-weight:bold; font-size:1.1rem;"></div>

    </form>
</div>

<script>
    // URLS POWER AUTOMATE
    const URL_BUSQUEDA = "https://prod-29.westus.logic.azure.com:443/workflows/aed1a8e6527c409fa89020e534c2b5c5/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=HdukGAnPtKgdUMkC1kbIqxd6pRyp_oZ_Q35IAtZGr-M";
    const URL_ENVIO = "https://prod-47.westus.logic.azure.com:443/workflows/241ab4c9e8dd4b499963538107ded6ae/triggers/manual/paths/invoke?api-version=2016-06-01&sp=%2Ftriggers%2Fmanual%2Frun&sv=1.0&sig=eYvcvi9mTH8wpW3_QaYhkhae6jiMGh4C38LaL1eEAZI";

    // Inicializaci√≥n
    document.addEventListener("DOMContentLoaded", () => {
        document.getElementById("fecha").value = new Date().toISOString().split("T")[0];
        const params = new URLSearchParams(window.location.search);
        if(params.get("serial")) document.getElementById("serial").value = params.get("serial");
    });

    // B√∫squeda
    async function realizarBusqueda(cedula, tipo) {
        if(!cedula) { alert("Escribe una c√©dula primero"); return; }
        
        const sufijo = tipo === 'colab' ? 'colaborador' : 'analista';
        const icono = document.getElementById("icono-busqueda-" + sufijo);
        const msg = document.getElementById("msg-" + sufijo);
        
        icono.innerHTML = '<span class="spinner"></span>'; 
        msg.innerText = "Conectando...";
        msg.style.color = "#666";

        try {
            const resp = await fetch(URL_BUSQUEDA, {
                method: "POST", headers: {"Content-Type":"application/json"},
                body: JSON.stringify({ cedula: cedula })
            });
            const data = await resp.json();

            icono.innerHTML = "üîç";

            if (data && data.nombre_colaborador) {
                msg.innerText = "‚úÖ Datos cargados";
                msg.style.color = "green";
                if(tipo === 'colab') {
                    document.getElementById("nombre_colaborador").value = data.nombre_colaborador;
                    document.getElementById("agencia").value = data.agencia || "";
                    document.getElementById("telefono").value = data.telefono || "";
                } else {
                    document.getElementById("nombre_analista").value = data.nombre_colaborador;
                    document.getElementById("agencia_analista").value = data.agencia || "";
                    document.getElementById("telefono_analista").value = data.telefono || "";
                }
            } else {
                msg.innerText = "‚ùå C√©dula no encontrada";
                msg.style.color = "red";
            }
        } catch (err) {
            console.error(err);
            icono.innerHTML = "üîç";
            msg.innerText = "‚ùå Error de conexi√≥n";
            msg.style.color = "red";
        }
    }

    window.buscarColaborador = () => realizarBusqueda(document.getElementById("cedula").value, 'colab');
    window.buscarAnalista = () => realizarBusqueda(document.getElementById("cedula_analista").value, 'analista');

    // Firmas
    function setupCanvas(id) {
        const c = document.getElementById(id);
        const ctx = c.getContext("2d");
        let drawing = false;
        
        const resize = () => { c.width = c.offsetWidth; c.height = 140; };
        resize();
        window.addEventListener('resize', resize);

        const start = (e) => {
            drawing = true; ctx.beginPath();
            const {left, top} = c.getBoundingClientRect();
            const x = (e.clientX || e.touches[0].clientX) - left;
            const y = (e.clientY || e.touches[0].clientY) - top;
            ctx.moveTo(x, y);
            e.preventDefault();
        };
        const move = (e) => {
            if(!drawing) return;
            const {left, top} = c.getBoundingClientRect();
            const x = (e.clientX || e.touches[0].clientX) - left;
            const y = (e.clientY || e.touches[0].clientY) - top;
            ctx.lineWidth = 2; ctx.lineCap = "round"; ctx.strokeStyle = "#000";
            ctx.lineTo(x, y); ctx.stroke();
            e.preventDefault();
        };
        const end = () => { drawing = false; };

        c.addEventListener("mousedown", start); c.addEventListener("touchstart", start, {passive:false});
        c.addEventListener("mousemove", move); c.addEventListener("touchmove", move, {passive:false});
        c.addEventListener("mouseup", end); c.addEventListener("touchend", end);
        c.addEventListener("mouseout", end);

        return {c, ctx};
    }

    const sigColab = setupCanvas("canvas_colaborador");
    const sigAna = setupCanvas("canvas_analista");

    window.limpiarFirma = (quien) => {
        const target = quien === 'colab' ? sigColab : sigAna;
        target.ctx.clearRect(0,0, target.c.width, target.c.height);
    };

    // Env√≠o
    document.getElementById("formulario").addEventListener("submit", async (e) => {
        e.preventDefault();
        const estadoDiv = document.getElementById("estado-envio");
        estadoDiv.innerHTML = '<span class="spinner" style="border-color: #666; border-top-color: #000;"></span> Generando...';

        const valRadio = (name) => {
            const el = document.querySelector(`input[name="${name}"]:checked`);
            return el ? el.value : "No";
        };
        const valSelect = (name) => document.querySelector(`[name="${name}"]`).value;
        const valInput = (id) => document.getElementById(id).value;

        const data = {
            cedula: valInput("cedula"),
            nombre_colaborador: valInput("nombre_colaborador"),
            agencia: valInput("agencia"),
            telefono: valInput("telefono"),
            correo_colaborador: valInput("correo_colaborador"),
            codigo_sap: valInput("codigo_sap"), // NUEVO CAMPO
            zona_colaborador: valInput("zona_colaborador"),
            operacion: valInput("operacion"),
            ciudad: valInput("ciudad"),
            fecha: valInput("fecha"),

            tipo_equipo: "Handheld",
            marca: valInput("marca"),
            modelo: valInput("modelo"),
            serial: valInput("serial"),

            entrega_terminal: valRadio("entrega_terminal"), estado_terminal: valSelect("estado_terminal"), obs_terminal: valInput("obs_terminal"),
            entrega_pantalla: valRadio("entrega_pantalla"), estado_pantalla: valSelect("estado_pantalla"), obs_pantalla: valInput("obs_pantalla"),
            entrega_estuche: valRadio("entrega_estuche"),   estado_estuche: valSelect("estado_estuche"),   obs_estuche: valInput("obs_estuche"),
            entrega_bateria: valRadio("entrega_bateria"),   estado_bateria: valSelect("estado_bateria_item"), obs_bateria: valInput("obs_bateria"),
            entrega_cargador: valRadio("entrega_cargador"), estado_cargador: valSelect("estado_cargador"), obs_cargador: valInput("obs_cargador"),
            entrega_cable: valRadio("entrega_cable"),       estado_cable: valSelect("estado_cable"),       obs_cable: valInput("obs_cable"),

            accesorios_adicionales: valInput("accesorios"), // NUEVO CAMPO
            observaciones: valInput("observaciones"),

            cedula_analista: valInput("cedula_analista"),
            nombre_analista: valInput("nombre_analista"),
            agencia_analista: valInput("agencia_analista"),
            telefono_analista: valInput("telefono_analista"),
            codigo_sap_analista: valInput("codigo_sap_analista"),
            cargo_analista: valInput("cargo_analista"),
            zona_analista: valInput("zona_analista"),

            firma_colaborador: sigColab.c.toDataURL().split(",")[1],
            firma_analista: sigAna.c.toDataURL().split(",")[1]
        };
        
        try {
            const resp = await fetch(URL_ENVIO, {
                method: "POST", headers: {"Content-Type":"application/json"},
                body: JSON.stringify(data)
            });
            if(resp.ok) {
                estadoDiv.innerText = "‚úÖ ¬°Enviado Exitosamente!";
                estadoDiv.style.color = "green";
                document.getElementById("formulario").reset();
                limpiarFirma('colab'); limpiarFirma('ana');
                document.getElementById("fecha").value = new Date().toISOString().split("T")[0];
            } else {
                throw new Error("Error API");
            }
        } catch(err) {
            estadoDiv.innerText = "‚ùå Error al enviar (Verificar Flujo)";
            estadoDiv.style.color = "red";
        }
    });

    const soloNumeros = e => e.target.value = e.target.value.replace(/[^0-9]/g, "");
    document.getElementById("cedula").addEventListener("input", soloNumeros);
    document.getElementById("cedula_analista").addEventListener("input", soloNumeros);
    document.getElementById("codigo_sap_analista").addEventListener("input", soloNumeros);
    document.getElementById("codigo_sap").addEventListener("input", soloNumeros); // Validaci√≥n para el nuevo campo
</script>

</body>
</html>
